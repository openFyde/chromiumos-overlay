From 1410ad82897c74bb7e6325c4c1dce801bdd3d9af Mon Sep 17 00:00:00 2001
From: Qijiang Fan <fqj@chromium.org>
Date: Fri, 1 Nov 2019 16:36:16 +0900
Subject: [PATCH] libchrome: r576279 forward compatibility patch part 5
 (metrics)

Change-Id: I719114256eb525116dca190908020c8e5f374b5a
---
 base/metrics/histogram_samples.h          | 8 ++++++++
 base/metrics/histogram_snapshot_manager.h | 7 +++++++
 base/metrics/statistics_recorder.h        | 5 +++++
 3 files changed, 20 insertions(+)

diff --git a/base/metrics/histogram_samples.h b/base/metrics/histogram_samples.h
index 93f6d21..7cdb18d 100644
--- a/base/metrics/histogram_samples.h
+++ b/base/metrics/histogram_samples.h
@@ -139,6 +139,14 @@ class BASE_EXPORT SampleCountIterator {
                    HistogramBase::Sample* max,
                    HistogramBase::Count* count) const = 0;
 
+  void Get(HistogramBase::Sample* min,
+           int64_t* max,
+           HistogramBase::Count* count) {
+    HistogramBase::Sample max32;
+    this->Get(min, &max32, count);
+    *max = max32;
+  }
+
   // Get the index of current histogram bucket.
   // For histograms that don't use predefined buckets, it returns false.
   // Requires: !Done();
diff --git a/base/metrics/histogram_snapshot_manager.h b/base/metrics/histogram_snapshot_manager.h
index de4a2e1..2a0d079 100644
--- a/base/metrics/histogram_snapshot_manager.h
+++ b/base/metrics/histogram_snapshot_manager.h
@@ -50,6 +50,13 @@ class BASE_EXPORT HistogramSnapshotManager {
     }
   }
 
+  void PrepareDeltas(const std::vector<HistogramBase*>& histograms,
+                     HistogramBase::Flags flags_to_set,
+                     HistogramBase::Flags required_flags) {
+    this->PrepareDeltas(histograms.begin(), histograms.end(),
+                        flags_to_set, required_flags);
+  }
+
   // When the collection is not so simple as can be done using a single
   // iterator, the steps can be performed separately. Call PerpareDelta()
   // as many times as necessary. PrepareFinalDelta() works like PrepareDelta()
diff --git a/base/metrics/statistics_recorder.h b/base/metrics/statistics_recorder.h
index 55be86a..48b3713 100644
--- a/base/metrics/statistics_recorder.h
+++ b/base/metrics/statistics_recorder.h
@@ -143,6 +143,11 @@ class BASE_EXPORT StatisticsRecorder {
 
   // Method for extracting histograms which were marked for use by UMA.
   static void GetHistograms(Histograms* output);
+  static Histograms GetHistograms() {
+    Histograms histograms;
+    GetHistograms(&histograms);
+    return histograms;
+  }
 
   // Method for extracting BucketRanges used by all histograms registered.
   static void GetBucketRanges(std::vector<const BucketRanges*>* output);
-- 
2.24.0.rc1.363.gb1bccd3e3d-goog

